# An attempt at a DNS system for Hyperboria

One of the key features that makes CJDNS a good solution is the way it handles IP address assignment. It’s decentralized and yet secure, the perfect combination for our goals: a network that can resist censorship or shut down attempts. There is a fundamental property of IP addresses, though, that made that possible, one that domain names do not share. If you understand this fundamental property, you see that a truly decentralized, secure, shared domain name space is literally not possible.

IP addresses are a commodity, they are all of equal value. Domain names are not.

Unlike IP addresses, where what particular identifier you get is essentially meaningless as long as it is unique to you and can be counted on to stay that way, what domain name you get matters a great deal and there is nothing anybody can do about it. The identifier itself has critical and unique meaning, and that is the entire point of the system in the first place. This means that at some point there has to be global agreement about which names point to which IP addresses, and that agreement has to be one that can be counted on and available to users. In other words, for a domain name system to work, there must be authority.

That puts us in a bit of a bind, doesn’t it? Authority is a form of centralization and can be censored or shut down, and thus defeats the purpose of Hyperboria in the first place, right? Well, not necessarily. It’s true that most authority is centralized and delegated (e.g. the current DNS system) and that’s the obvious easy way to accomplish it. That’s not to say it must be done that way, but the stark reality is that compromising it’s centralization necessarily compromises the authority. Meanwhile, bolstering centralization necessarily compromises censorship and shut down resistance. It’s no wonder DNS for Hyperboria has been such a hard nut to crack, the two key requirements have an inverse relationship!

Here I will propose we take an approach that, while not perfect, I hope can give us a good balance. By accepting some other compromises, I believe that we can optimise both decentralization and authority to the point where both are sufficient for our needs. The basic concept is one of multiple equal authorities, working together to cooperatively establish a domain name space according to a specific set of rules. I call this system the Domain Name Agreement Mesh, or DNAM for short. Let’s dive in, shall we?

## DNAM: Domain Name Agreement Mesh

So, who gets what name? That’s the first problem to solve, and the DNAM solution is the same as the one used for HypeDNS and for current internet DNS: first come first serve. (Of course, internet DNS is complicated by copyright and trademark litigation these days, but that is something I’m hoping we can avoid.)

The next problems we have are how we make this information available to users and how we ensure that users can trust it to be the correct, globally agreed upon information. This is where the “Agreement Mesh” part of the name comes in. Like the current internet system, we will need root name servers to act as the authorities for TLDs (top level domains). Unlike the current system, though, DNAM will not have a standard set of TLDs, and any anonymous user will be able to set up their own name server and act as a TLD authority. If you wish to be a TLD authority, you need only set up the server and select a TLD that has not been previously claimed. The software will associate you with the DNAM automatically by seeking consensus from the other members of the agreement mesh (how this consensus is reached is detailed below). Each member of the DNAM keeps track of all other members, including their IP addresses and their TLDs, both so that they can intercommunicate for consensus reaching, and so that any one of them can respond to client resolution requests as a DNS server for the system. The intention is that a small number of people with sufficient technical ability, resources, and desire will choose to implement said TLD authorities, and then provide domains under their TLD to the larger majority. If anyone is unhappy with the operation of a TLD authority, they can use a different TLD authority (and different TLD), or set up their own at any time and have equal authority to run their TLD authority how they believe it should be done, without any loss of interoperability. The result should be a name system that can respond to the needs and desires of all its users, even if they may be contradictory.

An important consideration at this point is interoperation with the current internet DNS system. In order to preserve that interoperation so that users need only add a DNS server to their host and go,  all DNAM TLDs must blacklist all other valid internet TLDs. Of particular note, this includes those that haven’t been implemented yet. In other words, if a new valid internet TLD is added in the future, and it collides with an existing TLD authority in the DNAM, then that TLD authority must change to a different TLD so as to no longer collide. This is not ideal, but is a necessary compromise. Those selecting TLDs for the DNAM are recommended to select names which are unlikely to ever become valid internet TLDs.

## Seeking Consensus

In order for a new TLD authority to successfully join a DNAM, it must establish a relationship with each and every TLD currently in that DNAM, and achieve a “consensus” with all members to permit it to join. The prospective new TLD authority will need to submit a join request to each member to be checked for availability and then cryptographically signed if approved. With each contact, information and public keys will also be exchanged for future use. Each current member, after approving and signing the request, will also provide a list of contact information for all other members known to it (which should generally be all of them). This means that the prospective new TLD authority needs only the contact information for one single member in order to begin the process. As signatures are acquired, they are added to the requests. Once the contacts on each member’s list have been themselves contacted and an approval signature acquired, and all the signatures are part of the request, the member will confirm each signature directly with the member that provided it, and then send a response to the new TLD authority letting it know that it is now considered a member.

All members of the DNAM will be expected to follow these rules, to be available to approve new members, and to fulfil resolution requests for all names within the DNAM. It is assumed that there will be caching for performance reasons. Note that, although members of the DNAM may certainly delegate domains under their TLDs to other standard name servers as they wish, those other name servers are not members, only TLD authorities may be members. Also note that every single TLD authority may be the authority of only one TLD, and must have a unique IP address. This is to prevent someone from trying to dump an entire dictionary file on to a server and similar nonsense, and to generally ensure that TLDs are not excessive in number, existing only as necessary to satisfy needs. If someone wishes to be the authority of more then one TLD, they will need more then one server on more then one Hyperboria node.

It’s worth noting that there is a significant amount of traffic involved in approving new members. This should not be a significant problem in general, as new join requests should not be common. By design, a significantly higher priority is placed on ensuring the security and integrity of the DNAM then on performance.

## Challenging a TLD: When good TLDs go bad… or away.

Eventually, some TLD authority is going to drop off the map and not come back. It is also possible that some TLD may simply start to function incorrectly, or even maliciously, and it’s administrator be unreachable or hostile. The challenge process is designed to deal with that.

In the case of a TLD becoming unreachable for a specific extended period of time (lets say 60 days for example purposes), a prospective new TLD authority may, instead of a join request for a new TLD, submit a challenge request for the existing TLD who’s authority is unreachable. Every other current member must check when it was last in contact with that authority and ensure that it was longer ago then the specified time (so more then 60 days), and then attempt one last time to contact that authority, only signing the request when it is certain that the authority is unreachable. It would be reasonable for this process to take some time, perhaps 24 hours or more, during which humans can be notified of the impending action. If every single other member approves, then the TLD in question has been successfully challenged and now belongs to the new member. If even one member is able to contact the unreachable authority, however, or otherwise fails to approve the challenge request, then the challenge request fails. This process should be very rare, and every effort should be made to ensure it is a last resort (trying to contact the existing authority’s administrator and such).

In the case of improper or malicious functioning, an existing member may submit a challenge request to the other members, which should trigger notifications to all the administrators of those members. The challenge should include information from the challenger stating why the challenge is made. This type of challenge probably should not be automated, and instead require manual approval from the administrators of each authority once they have investigated. If all approval signatures are acquired, the challenging authority will submit the signatures to all other members (including the target member if possible) and the target member who was operating improperly or maliciously will no longer be considered a member. The TLD in question will be permitted to age out, and will become available for challenging as laid out above (at an accelerated pace, since members will not need to attempt contact before approving).

## Additional Details

 * The encryption keys in question should be separate from the keys used by the CJDNS nodes and specific to the TLD authority server. They should, obviously, be of substantial strength. This author had GPG keys in mind while writing this document, but the specifics are not set in stone.

 * This system was designed with the intention of keeping the unique DNAM specific part of the system as contained as possible (while still maintaining sufficient decentralization) at the highest levels, so that the majority of the system, once in greater use, can utilize the same standard DNS software as the internet. It is considered desirable by this author that no common webmaster or, especially, client user be required to adapt unnecessarily to the system or install additional software. Nothing more then the addition of a name server should be necessary for a client user, and the efficiency and performance of the existing domain name system for client users should be replicated.

 * The astute reader will notice that there is nothing about this system that enforces a single DNAM. In fact, it is possible for more then one independent DNAM to exist on a network, much like it is possible for more then one CJDNS based network to exist independently, and this is by design. Unlike independent CJDNS networks, however, two DNAM’s are not generally compatible unless some additional effort is made by one of them to blacklist the TLDs in the other (making a “sub-DNAM” a possibility). The intention is that one DNAM will be the dominant default choice, but that it remains possible to start a competitor if the dominant DNAM fails to server the network well.


